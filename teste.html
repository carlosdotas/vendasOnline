<!DOCTYPE html>
<html>
<head>
	<title>Teste</title>
</head>
<script type="text/javascript" src="extension/jquery-easyui/jquery.min.js"></script>
<script type="text/javascript" src="src/js/funcoes.js"></script>
<script type="text/javascript" src="src/js/jquery.funcoes.js"></script>
<style type="text/css">
.selectTemplateJquery{
	background-color: #eee;
}
</style>

<body>
<div id="geral"></div>

<template id="linhaProdutos">
	Template
	<div>{id}</div> 
	<div>{nome}</div> 
	<div>R$ {preco} x {qnt} = {total}</div>
	<hr>
</template>

<button onclick="">SET</button>
<button onclick="">DEL</button>

<script type="text/javascript">

function criaCarrinho(){

	let listaDeProdutos={

		selected:'45254',
		lista:{}
	}

	listaDeProdutos.somarUm = (ProdutoId)=>{
		if(listaDeProdutos.lista[ProdutoId]){
			return ++listaDeProdutos.lista[ProdutoId].qnt;
		}else{
			return 1
		}
	}

	listaDeProdutos.subtrairUm = (ProdutoId)=>{
		if(listaDeProdutos.lista[ProdutoId]){
			return --listaDeProdutos.lista[ProdutoId].qnt;
		}
	}

	listaDeProdutos.setProdutoNaLista=(values)=>{
		
		let produtoID = values.id;
		let produtoNome = values.nome;
		let produtoPreco = values.preco.toFixed(2);
		let produtoQnt = listaDeProdutos.somarUm(produtoID);
		let produtoTotal =  (produtoQnt*values.preco).toFixed(2);

		listaDeProdutos.lista[produtoID] = {
			id:produtoID,
			nome:produtoNome,
			preco:produtoPreco,
			qnt:produtoQnt,
			total:produtoTotal,
		}
	}

	listaDeProdutos.delProdutoNaLista=(values)=>{
		delete listaDeProdutos.lista[values];
	}

	return listaDeProdutos;
}

const carrinho = criaCarrinho();
carrinho.setProdutoNaLista({
	id:45254,
	nome:'Vaneta1',
	preco:10.25,
});

carrinho.setProdutoNaLista({
	id:45252,
	nome:'Vaneta23',
	preco:10.5,
});	
carrinho.setProdutoNaLista({
	id:45253,
	nome:'Vaneta24',
	preco:0.25,
});

carrinho.subtrairUm(45253);
carrinho.subtrairUm(45253);
carrinho.subtrairUm(45253);

carrinho.setProdutoNaLista({
	id:45253,
	nome:'Vaneta25',
	preco:0.25,
});	
carrinho.setProdutoNaLista({
	id:45253,
	nome:'Vaneta26',
	preco:0.25,
});
carrinho.setProdutoNaLista({
	id:45253,
	nome:'Vaneta27',
	preco:0.25,
});
carrinho.setProdutoNaLista({
	id:45253,
	nome:'Vaneta28',
	preco:0.25,
});
carrinho.setProdutoNaLista({
	id:45253,
	nome:'Vaneta29',
	preco:2.65,
});		
carrinho.setProdutoNaLista({
	id:45255,
	nome:'Vaneta210',
	preco:1.39,
});
carrinho.setProdutoNaLista({
	id:45256,
	nome:'Vaneta211',
	preco:1.5,
});
carrinho.delProdutoNaLista(45256);	



$('#geral').templateJquery({
	data:carrinho.lista,
	template:'#linhaProdutos',
	onSelect:function(data){
		console.log(data);
	},	
});

//$('#geral').templateJquery('select',carrinho.selected);

//$('#geral').templateJquery('set',carrinho.selected);
//$('#geral').templateJquery('del',carrinho.selected);

$('.templateJquery').click(function(){
	$('#geral').templateJquery('select',$(this).attr('ref'));
})




//function renderListaProdutos(){
//	let listaCarrinhoHtml = geraListaHtml('#linhaProdutos',carrinho.lista);
//	$("#geral").html(listaCarrinhoHtml);
//}


//renderListaProdutos();




//console.log(carrinho);

</script>
</body>
</html>